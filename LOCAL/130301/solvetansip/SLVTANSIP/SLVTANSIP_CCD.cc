//--------------------------------------------------
//SLVTANSIP_CCD.cc
//
//
//Last Update 2013/02/01
//--------------------------------------------------
#include<iostream>
#include"SLVTANSIP_ANA.h"

using namespace std;

void CL_ANA::SHOW_CCD(int ID){
	cout <<"--- CCD INFO : "<<ID<<" ---"<<endl;
	cout <<"CHIPID		: "<<CCD[ID].ID_CHIP<<endl;
	cout <<"OBJNUM		: "<<CCD[ID].NUM_OBJ<<endl;
	cout <<"FITNUM		: "<<CCD[ID].NUM_FIT<<endl;
	cout <<"GPOS_X		: "<<CCD[ID].GPOS[0]<<endl;
	cout <<"GPOS_Y		: "<<CCD[ID].GPOS[1]<<endl;
	cout <<"GPOS_T		: "<<CCD[ID].GPOS[2]<<endl;
	cout <<"CRPIX1		: "<<CCD[ID].CRPIX[0]<<endl;
	cout <<"CRPIX2		: "<<CCD[ID].CRPIX[1]<<endl;
	cout <<"CRVAL1		: "<<CCD[ID].CRVAL[0]<<endl;
	cout <<"CRVAL2		: "<<CCD[ID].CRVAL[1]<<endl;
	cout <<"CD1_1		: "<<CCD[ID].CD[0][0]<<endl;
	cout <<"CD1_2		: "<<CCD[ID].CD[0][1]<<endl;
	cout <<"CD2_1		: "<<CCD[ID].CD[1][0]<<endl;
	cout <<"CD2_2		: "<<CCD[ID].CD[1][1]<<endl;
	cout <<"InvCD1_1	: "<<CCD[ID].InvCD[0][0]<<endl;
	cout <<"InvCD1_2	: "<<CCD[ID].InvCD[0][1]<<endl;
	cout <<"InvCD2_1	: "<<CCD[ID].InvCD[1][0]<<endl;
	cout <<"InvCD2_2	: "<<CCD[ID].InvCD[1][1]<<endl;
//	double *ASIP[2];
//	double *PSIP[2];
}
void CL_ANA::SET_INITCCD_SC(){
    CCD[  0].GPOS[0]= 3272.00;
    CCD[  0].GPOS[1]=   50.00;
    CCD[  0].GPOS[2]= 0.00000;
    CCD[  1].GPOS[0]= 1124.00;
    CCD[  1].GPOS[1]=   50.00;
    CCD[  1].GPOS[2]= 0.00000;
    CCD[  2].GPOS[0]=-1024.00;
    CCD[  2].GPOS[1]=   50.00;
    CCD[  2].GPOS[2]= 0.00000;
    CCD[  3].GPOS[0]= 3272.00;
    CCD[  3].GPOS[1]=-4146.00;
    CCD[  3].GPOS[2]= 0.00000;
    CCD[  4].GPOS[0]= 1124.00;
    CCD[  4].GPOS[1]=-4146.00;
    CCD[  4].GPOS[2]= 0.00000;
    CCD[  5].GPOS[0]=-1024.00;
    CCD[  5].GPOS[1]=-4146.00;
    CCD[  5].GPOS[2]= 0.00000;
    CCD[  6].GPOS[0]=-5320.00;
    CCD[  6].GPOS[1]=   50.00;
    CCD[  6].GPOS[2]= 0.00000;
    CCD[  7].GPOS[0]=-3172.00;
    CCD[  7].GPOS[1]=   50.00;
    CCD[  7].GPOS[2]= 0.00000;
    CCD[  8].GPOS[0]=-5320.00;
    CCD[  8].GPOS[1]=-4146.00;
    CCD[  8].GPOS[2]= 0.00000;
    CCD[  9].GPOS[0]=-3172.00;
    CCD[  9].GPOS[1]=-4146.00;
    CCD[  9].GPOS[2]= 0.00000;
    CCD[ 10].GPOS[0]= 0000.00;
    CCD[ 10].GPOS[1]= 0000.00;
    CCD[ 10].GPOS[2]= 0.00000;
    for(CID=0;CID<NUM_CCD+1;CID++){
        CCD[CID].ID_CHIP=CID;
        CCD[CID].GPOS_INIT[0]=CCD[CID].GPOS[0];
        CCD[CID].GPOS_INIT[1]=CCD[CID].GPOS[1];
        CCD[CID].GPOS_INIT[2]=CCD[CID].GPOS[2];
 	CCD[CID].CRPIX[0]=0;
 	CCD[CID].CRPIX[1]=0;
 	CCD[CID].CRVAL[0]=CRVAL[0];
 	CCD[CID].CRVAL[1]=CRVAL[1];
 	CCD[CID].CD[0][0]=0;
 	CCD[CID].CD[0][1]=0;
 	CCD[CID].CD[1][0]=0;
 	CCD[CID].CD[1][1]=0;
 	CCD[CID].InvCD[0][0]=0;
 	CCD[CID].InvCD[0][1]=0;
 	CCD[CID].InvCD[1][0]=0;
 	CCD[CID].InvCD[1][1]=0;
	CCD[CID].NUM_OBJ=0;
	CCD[CID].NUM_FIT=0;
    }
}
void CL_ANA::SET_INITCCD_HSC(){
    CSIP[0].GPOS[0]=	13835.7;
    CSIP[0].GPOS[1]=	-8918.13;
    CSIP[0].GPOS[2]=	-4.54687e-05;
    CSIP[1].GPOS[0]=	13836.5;
    CSIP[1].GPOS[1]=	-4439.67;
    CSIP[1].GPOS[2]=	-0.000112826;
    CSIP[2].GPOS[0]=	13837.3;
    CSIP[2].GPOS[1]=	35.1634;
    CSIP[2].GPOS[2]=	-9.53666e-05;
    CSIP[3].GPOS[0]=	13838.1;
    CSIP[3].GPOS[1]=	4512.62;
    CSIP[3].GPOS[2]=	-0.000241431;
    CSIP[4].GPOS[0]=	11711;
    CSIP[4].GPOS[1]=	-13392.7;
    CSIP[4].GPOS[2]=	2.83549e-06;
    CSIP[5].GPOS[0]=	11711.8;
    CSIP[5].GPOS[1]=	-8916.35;
    CSIP[5].GPOS[2]=	-0.000510185;
    CSIP[6].GPOS[0]=	11712.9;
    CSIP[6].GPOS[1]=	-4440.07;
    CSIP[6].GPOS[2]=	-0.00062244;
    CSIP[7].GPOS[0]=	11716.8;
    CSIP[7].GPOS[1]=	34.3342;
    CSIP[7].GPOS[2]=	0.000614981;
    CSIP[8].GPOS[0]=	11715.4;
    CSIP[8].GPOS[1]=	4513.46;
    CSIP[8].GPOS[2]=	-0.000646452;
    CSIP[9].GPOS[0]=	11716.1;
    CSIP[9].GPOS[1]=	8989.21;
    CSIP[9].GPOS[2]=	-0.00078577;
    CSIP[10].GPOS[0]=	9588.69;
    CSIP[10].GPOS[1]=	-13391.9;
    CSIP[10].GPOS[2]=	-0.000183744;
    CSIP[11].GPOS[0]=	9590.86;
    CSIP[11].GPOS[1]=	-8917.01;
    CSIP[11].GPOS[2]=	0.000576925;
    CSIP[12].GPOS[0]=	9589.48;
    CSIP[12].GPOS[1]=	-4435.47;
    CSIP[12].GPOS[2]=	-0.000681665;
    CSIP[13].GPOS[0]=	9589.01;
    CSIP[13].GPOS[1]=	36.828;
    CSIP[13].GPOS[2]=	-0.000667003;
    CSIP[14].GPOS[0]=	9594.49;
    CSIP[14].GPOS[1]=	4512;
    CSIP[14].GPOS[2]=	0.000230797;
    CSIP[15].GPOS[0]=	9593.56;
    CSIP[15].GPOS[1]=	8988.86;
    CSIP[15].GPOS[2]=	-0.000332099;
    CSIP[16].GPOS[0]=	7464.16;
    CSIP[16].GPOS[1]=	-13169.2;
    CSIP[16].GPOS[2]=	-0.000334858;
    CSIP[17].GPOS[0]=	7465.65;
    CSIP[17].GPOS[1]=	-8689.21;
    CSIP[17].GPOS[2]=	-0.000340941;
    CSIP[18].GPOS[0]=	7465.93;
    CSIP[18].GPOS[1]=	-4214.43;
    CSIP[18].GPOS[2]=	-0.000414322;
    CSIP[19].GPOS[0]=	7467.17;
    CSIP[19].GPOS[1]=	36.645;
    CSIP[19].GPOS[2]=	-7.34564e-05;
    CSIP[20].GPOS[0]=	7467.3;
    CSIP[20].GPOS[1]=	4513.84;
    CSIP[20].GPOS[2]=	-0.000535604;
    CSIP[21].GPOS[0]=	7473.86;
    CSIP[21].GPOS[1]=	8986.12;
    CSIP[21].GPOS[2]=	0.00115436;
    CSIP[22].GPOS[0]=	5340.47;
    CSIP[22].GPOS[1]=	-17642.2;
    CSIP[22].GPOS[2]=	-0.000126147;
    CSIP[23].GPOS[0]=	5344.79;
    CSIP[23].GPOS[1]=	-13166;
    CSIP[23].GPOS[2]=	0.00027998;
    CSIP[24].GPOS[0]=	5345.81;
    CSIP[24].GPOS[1]=	-8689.51;
    CSIP[24].GPOS[2]=	0.000616083;
    CSIP[25].GPOS[0]=	5343.96;
    CSIP[25].GPOS[1]=	-4211.39;
    CSIP[25].GPOS[2]=	0.000503702;
    CSIP[26].GPOS[0]=	5343.8;
    CSIP[26].GPOS[1]=	36.4384;
    CSIP[26].GPOS[2]=	-0.000469916;
    CSIP[27].GPOS[0]=	5347;
    CSIP[27].GPOS[1]=	4513.36;
    CSIP[27].GPOS[2]=	-0.000225362;
    CSIP[28].GPOS[0]=	5351.97;
    CSIP[28].GPOS[1]=	8987.31;
    CSIP[28].GPOS[2]=	0.000947141;
    CSIP[29].GPOS[0]=	5347.01;
    CSIP[29].GPOS[1]=	13465;
    CSIP[29].GPOS[2]=	-7.73811e-05;
    CSIP[30].GPOS[0]=	3220.82;
    CSIP[30].GPOS[1]=	-17642.3;
    CSIP[30].GPOS[2]=	0.000335482;
    CSIP[31].GPOS[0]=	3219.1;
    CSIP[31].GPOS[1]=	-13167.4;
    CSIP[31].GPOS[2]=	-0.000594003;
    CSIP[32].GPOS[0]=	3219.24;
    CSIP[32].GPOS[1]=	-8690.65;
    CSIP[32].GPOS[2]=	0.000281838;
    CSIP[33].GPOS[0]=	3222.43;
    CSIP[33].GPOS[1]=	-4213.31;
    CSIP[33].GPOS[2]=	0.000760842;
    CSIP[34].GPOS[0]=	3225.26;
    CSIP[34].GPOS[1]=	33.188;
    CSIP[34].GPOS[2]=	0.00383119;
    CSIP[35].GPOS[0]=	3222.06;
    CSIP[35].GPOS[1]=	4512.6;
    CSIP[35].GPOS[2]=	-0.00069161;
    CSIP[36].GPOS[0]=	3226.2;
    CSIP[36].GPOS[1]=	8986.99;
    CSIP[36].GPOS[2]=	0.000125877;
    CSIP[37].GPOS[0]=	3224.14;
    CSIP[37].GPOS[1]=	13465.3;
    CSIP[37].GPOS[2]=	-0.000270292;
    CSIP[38].GPOS[0]=	1096.79;
    CSIP[38].GPOS[1]=	-17641.8;
    CSIP[38].GPOS[2]=	-0.000226312;
    CSIP[39].GPOS[0]=	1095.48;
    CSIP[39].GPOS[1]=	-13165.3;
    CSIP[39].GPOS[2]=	-0.000422965;
    CSIP[40].GPOS[0]=	1097.47;
    CSIP[40].GPOS[1]=	-8689.95;
    CSIP[40].GPOS[2]=	1.55976e-05;
    CSIP[41].GPOS[0]=	1097.81;
    CSIP[41].GPOS[1]=	-4211.98;
    CSIP[41].GPOS[2]=	0.000353446;
    CSIP[42].GPOS[0]=	1099.38;
    CSIP[42].GPOS[1]=	36.0517;
    CSIP[42].GPOS[2]=	-0.000107356;
    CSIP[43].GPOS[0]=	1100.66;
    CSIP[43].GPOS[1]=	4512.63;
    CSIP[43].GPOS[2]=	5.24356e-05;
    CSIP[44].GPOS[0]=	1103.17;
    CSIP[44].GPOS[1]=	8989.36;
    CSIP[44].GPOS[2]=	0.000296259;
    CSIP[45].GPOS[0]=	1101.91;
    CSIP[45].GPOS[1]=	13464.9;
    CSIP[45].GPOS[2]=	-2.53376e-05;
    CSIP[46].GPOS[0]=	-1026.74;
    CSIP[46].GPOS[1]=	-17641.9;
    CSIP[46].GPOS[2]=	-0.000320893;
    CSIP[47].GPOS[0]=	-1027.89;
    CSIP[47].GPOS[1]=	-13165.7;
    CSIP[47].GPOS[2]=	4.94989e-05;
    CSIP[48].GPOS[0]=	-1025.51;
    CSIP[48].GPOS[1]=	-8690.7;
    CSIP[48].GPOS[2]=	3.2887e-06;
    CSIP[49].GPOS[0]=	-1025;
    CSIP[49].GPOS[1]=	-4214.12;
    CSIP[49].GPOS[2]=	0.000197968;
    CSIP[50].GPOS[0]=	-1024.96;
    CSIP[50].GPOS[1]=	36.9914;
    CSIP[50].GPOS[2]=	0.000499231;
    CSIP[51].GPOS[0]=	-1020.94;
    CSIP[51].GPOS[1]=	4511.93;
    CSIP[51].GPOS[2]=	0.00049229;
    CSIP[52].GPOS[0]=	-1021.65;
    CSIP[52].GPOS[1]=	8990.84;
    CSIP[52].GPOS[2]=	-0.00024973;
    CSIP[53].GPOS[0]=	-1020.64;
    CSIP[53].GPOS[1]=	13464.7;
    CSIP[53].GPOS[2]=	-0.000168522;
    CSIP[54].GPOS[0]=	-3148.99;
    CSIP[54].GPOS[1]=	-17642.3;
    CSIP[54].GPOS[2]=	-0.000504373;
    CSIP[55].GPOS[0]=	-3150.38;
    CSIP[55].GPOS[1]=	-13165.1;
    CSIP[55].GPOS[2]=	-0.00062316;
    CSIP[56].GPOS[0]=	-3147.94;
    CSIP[56].GPOS[1]=	-8688.81;
    CSIP[56].GPOS[2]=	-6.55715e-06;
    CSIP[57].GPOS[0]=	-3149.12;
    CSIP[57].GPOS[1]=	-4214.89;
    CSIP[57].GPOS[2]=	-0.000568245;
    CSIP[58].GPOS[0]=	-3147.36;
    CSIP[58].GPOS[1]=	36.5786;
    CSIP[58].GPOS[2]=	-0.000283492;
    CSIP[59].GPOS[0]=	-3145.11;
    CSIP[59].GPOS[1]=	4514.52;
    CSIP[59].GPOS[2]=	-0.000532731;
    CSIP[60].GPOS[0]=	-3141.72;
    CSIP[60].GPOS[1]=	8990.33;
    CSIP[60].GPOS[2]=	7.47808e-05;
    CSIP[61].GPOS[0]=	-3143.63;
    CSIP[61].GPOS[1]=	13466.3;
    CSIP[61].GPOS[2]=	-0.000128148;
    CSIP[62].GPOS[0]=	-5270.04;
    CSIP[62].GPOS[1]=	-17641.6;
    CSIP[62].GPOS[2]=	0.000180646;
    CSIP[63].GPOS[0]=	-5273.04;
    CSIP[63].GPOS[1]=	-13165.5;
    CSIP[63].GPOS[2]=	-2.14473e-05;
    CSIP[64].GPOS[0]=	-5272.53;
    CSIP[64].GPOS[1]=	-8687.67;
    CSIP[64].GPOS[2]=	-0.000325514;
    CSIP[65].GPOS[0]=	-5271.81;
    CSIP[65].GPOS[1]=	-4212.03;
    CSIP[65].GPOS[2]=	-0.00036776;
    CSIP[66].GPOS[0]=	-5270.5;
    CSIP[66].GPOS[1]=	38.163;
    CSIP[66].GPOS[2]=	-0.000383271;
    CSIP[67].GPOS[0]=	-5267.78;
    CSIP[67].GPOS[1]=	4516.3;
    CSIP[67].GPOS[2]=	-0.000379431;
    CSIP[68].GPOS[0]=	-5266.31;
    CSIP[68].GPOS[1]=	8989.46;
    CSIP[68].GPOS[2]=	0.000193886;
    CSIP[69].GPOS[0]=	-5265.91;
    CSIP[69].GPOS[1]=	13466.7;
    CSIP[69].GPOS[2]=	-0.000607749;
    CSIP[70].GPOS[0]=	-7398.07;
    CSIP[70].GPOS[1]=	-17640.1;
    CSIP[70].GPOS[2]=	-0.00117201;
    CSIP[71].GPOS[0]=	-7394.84;
    CSIP[71].GPOS[1]=	-13164.9;
    CSIP[71].GPOS[2]=	-6.90706e-06;
    CSIP[72].GPOS[0]=	-7393.47;
    CSIP[72].GPOS[1]=	-8687.95;
    CSIP[72].GPOS[2]=	1.62334e-05;
    CSIP[73].GPOS[0]=	-7397.11;
    CSIP[73].GPOS[1]=	-4213.17;
    CSIP[73].GPOS[2]=	8.62186e-05;
    CSIP[74].GPOS[0]=	-7393.47;
    CSIP[74].GPOS[1]=	39.9441;
    CSIP[74].GPOS[2]=	-0.00024495;
    CSIP[75].GPOS[0]=	-7391.15;
    CSIP[75].GPOS[1]=	4517.26;
    CSIP[75].GPOS[2]=	-0.000441489;
    CSIP[76].GPOS[0]=	-7389.91;
    CSIP[76].GPOS[1]=	8992.49;
    CSIP[76].GPOS[2]=	-0.000291533;
    CSIP[77].GPOS[0]=	-7389.2;
    CSIP[77].GPOS[1]=	13467.2;
    CSIP[77].GPOS[2]=	-1.10801e-05;
    CSIP[78].GPOS[0]=	-9514.89;
    CSIP[78].GPOS[1]=	-13167.7;
    CSIP[78].GPOS[2]=	0.000840672;
    CSIP[79].GPOS[0]=	-9515.81;
    CSIP[79].GPOS[1]=	-8687.35;
    CSIP[79].GPOS[2]=	0.000577452;
    CSIP[80].GPOS[0]=	-9517.41;
    CSIP[80].GPOS[1]=	-4211.12;
    CSIP[80].GPOS[2]=	9.24942e-05;
    CSIP[81].GPOS[0]=	-9518.8;
    CSIP[81].GPOS[1]=	42.2764;
    CSIP[81].GPOS[2]=	-0.000368123;
    CSIP[82].GPOS[0]=	-9514.79;
    CSIP[82].GPOS[1]=	4515.56;
    CSIP[82].GPOS[2]=	-0.000143378;
    CSIP[83].GPOS[0]=	-9511.23;
    CSIP[83].GPOS[1]=	8990.2;
    CSIP[83].GPOS[2]=	0.000421181;
    CSIP[84].GPOS[0]=	-11638.8;
    CSIP[84].GPOS[1]=	-13165.4;
    CSIP[84].GPOS[2]=	0.000659965;
    CSIP[85].GPOS[0]=	-11638.7;
    CSIP[85].GPOS[1]=	-8689.14;
    CSIP[85].GPOS[2]=	0.000493703;
    CSIP[86].GPOS[0]=	-11641.3;
    CSIP[86].GPOS[1]=	-4210.68;
    CSIP[86].GPOS[2]=	0.000362076;
    CSIP[87].GPOS[0]=	-11637.3;
    CSIP[87].GPOS[1]=	257.02;
    CSIP[87].GPOS[2]=	0.00496935;
    CSIP[88].GPOS[0]=	-11638.2;
    CSIP[88].GPOS[1]=	4740.52;
    CSIP[88].GPOS[2]=	-0.000876723;
    CSIP[89].GPOS[0]=	-11634.8;
    CSIP[89].GPOS[1]=	9214.94;
    CSIP[89].GPOS[2]=	0.000313883;
    CSIP[90].GPOS[0]=	-13762.2;
    CSIP[90].GPOS[1]=	-13163.7;
    CSIP[90].GPOS[2]=	9.79203e-05;
    CSIP[91].GPOS[0]=	-13762.8;
    CSIP[91].GPOS[1]=	-8689.54;
    CSIP[91].GPOS[2]=	0.000796186;
    CSIP[92].GPOS[0]=	-13763.6;
    CSIP[92].GPOS[1]=	-4212.59;
    CSIP[92].GPOS[2]=	0.000321249;
    CSIP[93].GPOS[0]=	-13766.4;
    CSIP[93].GPOS[1]=	263.342;
    CSIP[93].GPOS[2]=	-0.000982624;
    CSIP[94].GPOS[0]=	-13759.8;
    CSIP[94].GPOS[1]=	4742.02;
    CSIP[94].GPOS[2]=	-0.000555047;
    CSIP[95].GPOS[0]=	-13758.5;
    CSIP[95].GPOS[1]=	9215.67;
    CSIP[95].GPOS[2]=	7.65291e-05;
    CSIP[96].GPOS[0]=	-15886.3;
    CSIP[96].GPOS[1]=	-8690.38;
    CSIP[96].GPOS[2]=	0.000227137;
    CSIP[97].GPOS[0]=	-15888;
    CSIP[97].GPOS[1]=	-4212.33;
    CSIP[97].GPOS[2]=	8.64849e-05;
    CSIP[98].GPOS[0]=	-15889.9;
    CSIP[98].GPOS[1]=	265.318;
    CSIP[98].GPOS[2]=	-0.00144577;
    CSIP[99].GPOS[0]=	-15886.3;
    CSIP[99].GPOS[1]=	4743.51;
    CSIP[99].GPOS[2]=	-0.00123912;

    CCD[100].GPOS[0]=  0000.000;
    CCD[100].GPOS[1]=  0000.000;
    CCD[100].GPOS[2]=  0.000000;

if(NUM_CCD>100){
    CSIP[100].GPOS[0]=	7498.91;
    CSIP[100].GPOS[1]=	-15513.9;
    CSIP[100].GPOS[2]=	-0.000238638;
    CSIP[101].GPOS[0]=	7505.99;
    CSIP[101].GPOS[1]=	13465.7;
    CSIP[101].GPOS[2]=	-3.28791e-05;
    CSIP[102].GPOS[0]=	-11680.1;
    CSIP[102].GPOS[1]=	-15514;
    CSIP[102].GPOS[2]=	0.000560241;
    CSIP[103].GPOS[0]=	-11675;
    CSIP[103].GPOS[1]=	13466.8;
    CSIP[103].GPOS[2]=	2.41631e-05;

    CCD[104].GPOS[0]=  0000.000;
    CCD[104].GPOS[1]=  0000.000;
    CCD[104].GPOS[2]=  0.000000;
}
    for(CID=0;CID<NUM_CCD+1;CID++){
        CCD[CID].ID_CHIP=CID;
        CCD[CID].GPOS_INIT[0]=CCD[CID].GPOS[0];
        CCD[CID].GPOS_INIT[1]=CCD[CID].GPOS[1];
        CCD[CID].GPOS_INIT[2]=CCD[CID].GPOS[2];
 	CCD[CID].CRPIX[0]=0;
 	CCD[CID].CRPIX[1]=0;
  	CCD[CID].CRVAL[0]=CRVAL[0];
 	CCD[CID].CRVAL[1]=CRVAL[1];
 	CCD[CID].CD[0][0]=0;
 	CCD[CID].CD[0][1]=0;
 	CCD[CID].CD[1][0]=0;
 	CCD[CID].CD[1][1]=0;
 	CCD[CID].InvCD[0][0]=0;
 	CCD[CID].InvCD[0][1]=0;
 	CCD[CID].InvCD[1][0]=0;
 	CCD[CID].InvCD[1][1]=0;
	CCD[CID].NUM_OBJ=0;
	CCD[CID].NUM_FIT=0;
   }

}
