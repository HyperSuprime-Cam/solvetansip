//--------------------------------------------------
//SLVTANSIP_CCD.cc
//
//
//Last Update 2013/02/01
//--------------------------------------------------
#include<iostream>
#include"SLVTANSIP_ANA.h"

using namespace std;

void CL_ANA::SHOW_CCD(int ID){
	cout <<"--- CCD INFO : "<<ID<<" ---"<<endl;
	cout <<"CHIPID		: "<<CCD[ID].ID_CHIP<<endl;
	cout <<"OBJNUM		: "<<CCD[ID].NUM_OBJ<<endl;
	cout <<"FITNUM		: "<<CCD[ID].NUM_FIT<<endl;
	cout <<"GPOS_X		: "<<CCD[ID].GPOS[0]<<endl;
	cout <<"GPOS_Y		: "<<CCD[ID].GPOS[1]<<endl;
	cout <<"GPOS_T		: "<<CCD[ID].GPOS[2]<<endl;
	cout <<"CRPIX1		: "<<CCD[ID].CRPIX[0]<<endl;
	cout <<"CRPIX2		: "<<CCD[ID].CRPIX[1]<<endl;
	cout <<"CRVAL1		: "<<CCD[ID].CRVAL[0]<<endl;
	cout <<"CRVAL2		: "<<CCD[ID].CRVAL[1]<<endl;
	cout <<"CD1_1		: "<<CCD[ID].CD[0][0]<<endl;
	cout <<"CD1_2		: "<<CCD[ID].CD[0][1]<<endl;
	cout <<"CD2_1		: "<<CCD[ID].CD[1][0]<<endl;
	cout <<"CD2_2		: "<<CCD[ID].CD[1][1]<<endl;
	cout <<"InvCD1_1	: "<<CCD[ID].InvCD[0][0]<<endl;
	cout <<"InvCD1_2	: "<<CCD[ID].InvCD[0][1]<<endl;
	cout <<"InvCD2_1	: "<<CCD[ID].InvCD[1][0]<<endl;
	cout <<"InvCD2_2	: "<<CCD[ID].InvCD[1][1]<<endl;
//	double *ASIP[2];
//	double *PSIP[2];
}
void CL_ANA::SET_INITCCD_SC(){
    CCD[  0].GPOS[0]= 3272.00;
    CCD[  0].GPOS[1]=   50.00;
    CCD[  0].GPOS[2]= 0.00000;
    CCD[  1].GPOS[0]= 1124.00;
    CCD[  1].GPOS[1]=   50.00;
    CCD[  1].GPOS[2]= 0.00000;
    CCD[  2].GPOS[0]=-1024.00;
    CCD[  2].GPOS[1]=   50.00;
    CCD[  2].GPOS[2]= 0.00000;
    CCD[  3].GPOS[0]= 3272.00;
    CCD[  3].GPOS[1]=-4146.00;
    CCD[  3].GPOS[2]= 0.00000;
    CCD[  4].GPOS[0]= 1124.00;
    CCD[  4].GPOS[1]=-4146.00;
    CCD[  4].GPOS[2]= 0.00000;
    CCD[  5].GPOS[0]=-1024.00;
    CCD[  5].GPOS[1]=-4146.00;
    CCD[  5].GPOS[2]= 0.00000;
    CCD[  6].GPOS[0]=-5320.00;
    CCD[  6].GPOS[1]=   50.00;
    CCD[  6].GPOS[2]= 0.00000;
    CCD[  7].GPOS[0]=-3172.00;
    CCD[  7].GPOS[1]=   50.00;
    CCD[  7].GPOS[2]= 0.00000;
    CCD[  8].GPOS[0]=-5320.00;
    CCD[  8].GPOS[1]=-4146.00;
    CCD[  8].GPOS[2]= 0.00000;
    CCD[  9].GPOS[0]=-3172.00;
    CCD[  9].GPOS[1]=-4146.00;
    CCD[  9].GPOS[2]= 0.00000;
    CCD[ 10].GPOS[0]= 0000.00;
    CCD[ 10].GPOS[1]= 0000.00;
    CCD[ 10].GPOS[2]= 0.00000;
    for(CID=0;CID<NUM_CCD+1;CID++){
        CCD[CID].ID_CHIP=CID;
        CCD[CID].GPOS_INIT[0]=CCD[CID].GPOS[0];
        CCD[CID].GPOS_INIT[1]=CCD[CID].GPOS[1];
        CCD[CID].GPOS_INIT[2]=CCD[CID].GPOS[2];
 	CCD[CID].CRPIX[0]=0;
 	CCD[CID].CRPIX[1]=0;
 	CCD[CID].CRVAL[0]=CRVAL[0];
 	CCD[CID].CRVAL[1]=CRVAL[1];
 	CCD[CID].CD[0][0]=0;
 	CCD[CID].CD[0][1]=0;
 	CCD[CID].CD[1][0]=0;
 	CCD[CID].CD[1][1]=0;
 	CCD[CID].InvCD[0][0]=0;
 	CCD[CID].InvCD[0][1]=0;
 	CCD[CID].InvCD[1][0]=0;
 	CCD[CID].InvCD[1][1]=0;
	CCD[CID].NUM_OBJ=0;
	CCD[CID].NUM_FIT=0;
    }
}
void CL_ANA::SET_INITCCD_HSC(){
    CCD[  0].GPOS[0]=- 9514.700;
    CCD[  0].GPOS[1]=    37.350;
    CCD[  0].GPOS[2]=  0.000000;
    CCD[  1].GPOS[0]=  7466.700;
    CCD[  1].GPOS[1]=- 4133.350;
    CCD[  1].GPOS[2]=  0.000000;
    CCD[  2].GPOS[0]=- 7392.000;
    CCD[  2].GPOS[1]=    37.350;
    CCD[  2].GPOS[2]=  0.000000;
    CCD[  3].GPOS[0]=  5344.000;
    CCD[  3].GPOS[1]=- 4133.350;
    CCD[  3].GPOS[2]=  0.000000;
    CCD[  4].GPOS[0]=- 5269.300;
    CCD[  4].GPOS[1]=    37.350;
    CCD[  4].GPOS[2]=  0.000000;
    CCD[  5].GPOS[0]=  3221.300;
    CCD[  5].GPOS[1]=- 4133.350;
    CCD[  5].GPOS[2]=  0.000000;
    CCD[  6].GPOS[0]=- 3146.700;
    CCD[  6].GPOS[1]=    37.350;
    CCD[  6].GPOS[2]=  0.000000;
    CCD[  7].GPOS[0]=  1098.700;
    CCD[  7].GPOS[1]=- 4133.350;
    CCD[  7].GPOS[2]=  0.000000;
    CCD[  8].GPOS[0]=- 1024.000;
    CCD[  8].GPOS[1]=    37.350;
    CCD[  8].GPOS[2]=  0.000000;
    CCD[  9].GPOS[0]=- 1024.000;
    CCD[  9].GPOS[1]=- 4133.350;
    CCD[  9].GPOS[2]=  0.000000;
    CCD[ 10].GPOS[0]=  1098.700;
    CCD[ 10].GPOS[1]=    37.350;
    CCD[ 10].GPOS[2]=  0.000000;
    CCD[ 11].GPOS[0]=- 3146.700;
    CCD[ 11].GPOS[1]=- 4133.350;
    CCD[ 11].GPOS[2]=  0.000000;
    CCD[ 12].GPOS[0]=  3221.300;
    CCD[ 12].GPOS[1]=    37.350;
    CCD[ 12].GPOS[2]=  0.000000;
    CCD[ 13].GPOS[0]=- 5269.300;
    CCD[ 13].GPOS[1]=- 4133.350;
    CCD[ 13].GPOS[2]=  0.000000;
    CCD[ 14].GPOS[0]=  5344.000;
    CCD[ 14].GPOS[1]=    37.350;
    CCD[ 14].GPOS[2]=  0.000000;
    CCD[ 15].GPOS[0]=- 7392.000;
    CCD[ 15].GPOS[1]=- 4133.350;
    CCD[ 15].GPOS[2]=  0.000000;
    CCD[ 16].GPOS[0]=  7466.700;
    CCD[ 16].GPOS[1]=    37.350;
    CCD[ 16].GPOS[2]=  0.000000;
    CCD[ 17].GPOS[0]=- 9514.700;
    CCD[ 17].GPOS[1]=- 4133.350;
    CCD[ 17].GPOS[2]=  0.000000;
    CCD[ 18].GPOS[0]=  9589.300;
    CCD[ 18].GPOS[1]=    37.350;
    CCD[ 18].GPOS[2]=  0.000000;
    CCD[ 19].GPOS[0]=-11637.300;
    CCD[ 19].GPOS[1]=- 4133.350;
    CCD[ 19].GPOS[2]=  0.000000;
    CCD[ 20].GPOS[0]= 11712.000;
    CCD[ 20].GPOS[1]=    37.350;
    CCD[ 20].GPOS[2]=  0.000000;
    CCD[ 21].GPOS[0]=-13760.000;
    CCD[ 21].GPOS[1]=- 4133.350;
    CCD[ 21].GPOS[2]=  0.000000;
    CCD[ 22].GPOS[0]= 13834.700;
    CCD[ 22].GPOS[1]=    37.350;
    CCD[ 22].GPOS[2]=  0.000000;
    CCD[ 23].GPOS[0]=-15882.700;
    CCD[ 23].GPOS[1]=- 4133.350;
    CCD[ 23].GPOS[2]=  0.000000;
    CCD[ 24].GPOS[0]=- 9514.700;
    CCD[ 24].GPOS[1]=  4512.350;
    CCD[ 24].GPOS[2]=  0.000000;
    CCD[ 25].GPOS[0]=  7466.700;
    CCD[ 25].GPOS[1]=- 8608.350;
    CCD[ 25].GPOS[2]=  0.000000;
    CCD[ 26].GPOS[0]=- 7392.000;
    CCD[ 26].GPOS[1]=  4512.350;
    CCD[ 26].GPOS[2]=  0.000000;
    CCD[ 27].GPOS[0]=  5344.000;
    CCD[ 27].GPOS[1]=- 8608.350;
    CCD[ 27].GPOS[2]=  0.000000;
    CCD[ 28].GPOS[0]=- 5269.300;
    CCD[ 28].GPOS[1]=  4512.350;
    CCD[ 28].GPOS[2]=  0.000000;
    CCD[ 29].GPOS[0]=  3221.300;
    CCD[ 29].GPOS[1]=- 8608.350;
    CCD[ 29].GPOS[2]=  0.000000;
    CCD[ 30].GPOS[0]=- 3146.700;
    CCD[ 30].GPOS[1]=  4512.350;
    CCD[ 30].GPOS[2]=  0.000000;
    CCD[ 31].GPOS[0]=  1098.700;
    CCD[ 31].GPOS[1]=- 8608.350;
    CCD[ 31].GPOS[2]=  0.000000;
    CCD[ 32].GPOS[0]=- 1024.000;
    CCD[ 32].GPOS[1]=  4512.350;
    CCD[ 32].GPOS[2]=  0.000000;
    CCD[ 33].GPOS[0]=- 1024.000;
    CCD[ 33].GPOS[1]=- 8608.350;
    CCD[ 33].GPOS[2]=  0.000000;
    CCD[ 34].GPOS[0]=  1098.700;
    CCD[ 34].GPOS[1]=  4512.350;
    CCD[ 34].GPOS[2]=  0.000000;
    CCD[ 35].GPOS[0]=- 3146.700;
    CCD[ 35].GPOS[1]=- 8608.350;
    CCD[ 35].GPOS[2]=  0.000000;
    CCD[ 36].GPOS[0]=  3221.300;
    CCD[ 36].GPOS[1]=  4512.350;
    CCD[ 36].GPOS[2]=  0.000000;
    CCD[ 37].GPOS[0]=- 5269.300;
    CCD[ 37].GPOS[1]=- 8608.350;
    CCD[ 37].GPOS[2]=  0.000000;
    CCD[ 38].GPOS[0]=  5344.000;
    CCD[ 38].GPOS[1]=  4512.350;
    CCD[ 38].GPOS[2]=  0.000000;
    CCD[ 39].GPOS[0]=- 7392.000;
    CCD[ 39].GPOS[1]=- 8608.350;
    CCD[ 39].GPOS[2]=  0.000000;
    CCD[ 40].GPOS[0]=  7466.700;
    CCD[ 40].GPOS[1]=  4512.350;
    CCD[ 40].GPOS[2]=  0.000000;
    CCD[ 41].GPOS[0]=- 9514.700;
    CCD[ 41].GPOS[1]=- 8608.350;
    CCD[ 41].GPOS[2]=  0.000000;
    CCD[ 42].GPOS[0]=  9589.300;
    CCD[ 42].GPOS[1]=  4512.350;
    CCD[ 42].GPOS[2]=  0.000000;
    CCD[ 43].GPOS[0]=-11637.300;
    CCD[ 43].GPOS[1]=- 8608.350;
    CCD[ 43].GPOS[2]=  0.000000;
    CCD[ 44].GPOS[0]= 11712.000;
    CCD[ 44].GPOS[1]=  4512.350;
    CCD[ 44].GPOS[2]=  0.000000;
    CCD[ 45].GPOS[0]=-13760.000;
    CCD[ 45].GPOS[1]=- 8608.350;
    CCD[ 45].GPOS[2]=  0.000000;
    CCD[ 46].GPOS[0]= 13834.700;
    CCD[ 46].GPOS[1]=  4512.350;
    CCD[ 46].GPOS[2]=  0.000000;
    CCD[ 47].GPOS[0]=-15882.700;
    CCD[ 47].GPOS[1]=- 8608.350;
    CCD[ 47].GPOS[2]=  0.000000;
    CCD[ 48].GPOS[0]=- 9514.700;
    CCD[ 48].GPOS[1]=  8987.350;
    CCD[ 48].GPOS[2]=  0.000000;
    CCD[ 49].GPOS[0]=  7466.700;
    CCD[ 49].GPOS[1]=-13083.350;
    CCD[ 49].GPOS[2]=  0.000000;
    CCD[ 50].GPOS[0]=- 7392.000;
    CCD[ 50].GPOS[1]=  8987.350;
    CCD[ 50].GPOS[2]=  0.000000;
    CCD[ 51].GPOS[0]=  5344.000;
    CCD[ 51].GPOS[1]=-13083.350;
    CCD[ 51].GPOS[2]=  0.000000;
    CCD[ 52].GPOS[0]=- 5269.300;
    CCD[ 52].GPOS[1]=  8987.350;
    CCD[ 52].GPOS[2]=  0.000000;
    CCD[ 53].GPOS[0]=  3221.300;
    CCD[ 53].GPOS[1]=-13083.350;
    CCD[ 53].GPOS[2]=  0.000000;
    CCD[ 54].GPOS[0]=- 3146.700;
    CCD[ 54].GPOS[1]=  8987.350;
    CCD[ 54].GPOS[2]=  0.000000;
    CCD[ 55].GPOS[0]=  1098.700;
    CCD[ 55].GPOS[1]=-13083.350;
    CCD[ 55].GPOS[2]=  0.000000;
    CCD[ 56].GPOS[0]=- 1024.000;
    CCD[ 56].GPOS[1]=  8987.350;
    CCD[ 56].GPOS[2]=  0.000000;
    CCD[ 57].GPOS[0]=- 1024.000;
    CCD[ 57].GPOS[1]=-13083.350;
    CCD[ 57].GPOS[2]=  0.000000;
    CCD[ 58].GPOS[0]=  1098.700;
    CCD[ 58].GPOS[1]=  8987.350;
    CCD[ 58].GPOS[2]=  0.000000;
    CCD[ 59].GPOS[0]=- 3146.700;
    CCD[ 59].GPOS[1]=-13083.350;
    CCD[ 59].GPOS[2]=  0.000000;
    CCD[ 60].GPOS[0]=  3221.300;
    CCD[ 60].GPOS[1]=  8987.350;
    CCD[ 60].GPOS[2]=  0.000000;
    CCD[ 61].GPOS[0]=- 5269.300;
    CCD[ 61].GPOS[1]=-13083.350;
    CCD[ 61].GPOS[2]=  0.000000;
    CCD[ 62].GPOS[0]=  5344.000;
    CCD[ 62].GPOS[1]=  8987.350;
    CCD[ 62].GPOS[2]=  0.000000;
    CCD[ 63].GPOS[0]=- 7392.000;
    CCD[ 63].GPOS[1]=-13083.350;
    CCD[ 63].GPOS[2]=  0.000000;
    CCD[ 64].GPOS[0]=  7466.700;
    CCD[ 64].GPOS[1]=  8987.350;
    CCD[ 64].GPOS[2]=  0.000000;
    CCD[ 65].GPOS[0]=- 9514.700;
    CCD[ 65].GPOS[1]=-13083.350;
    CCD[ 65].GPOS[2]=  0.000000;
    CCD[ 66].GPOS[0]=  9589.300;
    CCD[ 66].GPOS[1]=  8987.350;
    CCD[ 66].GPOS[2]=  0.000000;
    CCD[ 67].GPOS[0]=-11637.300;
    CCD[ 67].GPOS[1]=-13083.350;
    CCD[ 67].GPOS[2]=  0.000000;
    CCD[ 68].GPOS[0]= 11712.000;
    CCD[ 68].GPOS[1]=  8987.350;
    CCD[ 68].GPOS[2]=  0.000000;
    CCD[ 69].GPOS[0]=-13760.000;
    CCD[ 69].GPOS[1]=-13083.350;
    CCD[ 69].GPOS[2]=  0.000000;
    CCD[ 70].GPOS[0]=- 7392.000;
    CCD[ 70].GPOS[1]= 13462.350;
    CCD[ 70].GPOS[2]=  0.000000;
    CCD[ 71].GPOS[0]=  5344.000;
    CCD[ 71].GPOS[1]=-17558.350;
    CCD[ 71].GPOS[2]=  0.000000;
    CCD[ 72].GPOS[0]=- 5269.300;
    CCD[ 72].GPOS[1]= 13462.350;
    CCD[ 72].GPOS[2]=  0.000000;
    CCD[ 73].GPOS[0]=  3221.300;
    CCD[ 73].GPOS[1]=-17558.350;
    CCD[ 73].GPOS[2]=  0.000000;
    CCD[ 74].GPOS[0]=- 3146.700;
    CCD[ 74].GPOS[1]= 13462.350;
    CCD[ 74].GPOS[2]=  0.000000;
    CCD[ 75].GPOS[0]=  1098.700;
    CCD[ 75].GPOS[1]=-17558.350;
    CCD[ 75].GPOS[2]=  0.000000;
    CCD[ 76].GPOS[0]=- 1024.000;
    CCD[ 76].GPOS[1]= 13462.350;
    CCD[ 76].GPOS[2]=  0.000000;
    CCD[ 77].GPOS[0]=- 1024.000;
    CCD[ 77].GPOS[1]=-17558.350;
    CCD[ 77].GPOS[2]=  0.000000;
    CCD[ 78].GPOS[0]=  1098.700;
    CCD[ 78].GPOS[1]= 13462.350;
    CCD[ 78].GPOS[2]=  0.000000;
    CCD[ 79].GPOS[0]=- 3146.700;
    CCD[ 79].GPOS[1]=-17558.350;
    CCD[ 79].GPOS[2]=  0.000000;
    CCD[ 80].GPOS[0]=  3221.300;
    CCD[ 80].GPOS[1]= 13462.350;
    CCD[ 80].GPOS[2]=  0.000000;
    CCD[ 81].GPOS[0]=- 5269.300;
    CCD[ 81].GPOS[1]=-17558.350;
    CCD[ 81].GPOS[2]=  0.000000;
    CCD[ 82].GPOS[0]=  5344.000;
    CCD[ 82].GPOS[1]= 13462.350;
    CCD[ 82].GPOS[2]=  0.000000;
    CCD[ 83].GPOS[0]=- 7392.000;
    CCD[ 83].GPOS[1]=-17558.350;
    CCD[ 83].GPOS[2]=  0.000000;
    CCD[ 84].GPOS[0]=  9589.300;
    CCD[ 84].GPOS[1]=- 4437.650;
    CCD[ 84].GPOS[2]=  0.000000;
    CCD[ 85].GPOS[0]=-11637.300;
    CCD[ 85].GPOS[1]=   341.650;
    CCD[ 85].GPOS[2]=  0.000000;
    CCD[ 86].GPOS[0]= 11712.000;
    CCD[ 86].GPOS[1]=- 4437.650;
    CCD[ 86].GPOS[2]=  0.000000;
    CCD[ 87].GPOS[0]=-13760.000;
    CCD[ 87].GPOS[1]=   341.650;
    CCD[ 87].GPOS[2]=  0.000000;
    CCD[ 88].GPOS[0]= 13834.700;
    CCD[ 88].GPOS[1]=- 4437.650;
    CCD[ 88].GPOS[2]=  0.000000;
    CCD[ 89].GPOS[0]=-15882.700;
    CCD[ 89].GPOS[1]=   341.650;
    CCD[ 89].GPOS[2]=  0.000000;
    CCD[ 90].GPOS[0]=  9589.300;
    CCD[ 90].GPOS[1]=- 8912.650;
    CCD[ 90].GPOS[2]=  0.000000;
    CCD[ 91].GPOS[0]=-11637.300;
    CCD[ 91].GPOS[1]=  4816.650;
    CCD[ 91].GPOS[2]=  0.000000;
    CCD[ 92].GPOS[0]= 11712.000;
    CCD[ 92].GPOS[1]=- 8912.650;
    CCD[ 92].GPOS[2]=  0.000000;
    CCD[ 93].GPOS[0]=-13760.000;
    CCD[ 93].GPOS[1]=  4816.650;
    CCD[ 93].GPOS[2]=  0.000000;
    CCD[ 94].GPOS[0]= 13834.700;
    CCD[ 94].GPOS[1]=- 8912.650;
    CCD[ 94].GPOS[2]=  0.000000;
    CCD[ 95].GPOS[0]=-15882.700;
    CCD[ 95].GPOS[1]=  4816.650;
    CCD[ 95].GPOS[2]=  0.000000;
    CCD[ 96].GPOS[0]=  9589.300;
    CCD[ 96].GPOS[1]=-13387.650;
    CCD[ 96].GPOS[2]=  0.000000;
    CCD[ 97].GPOS[0]=-11637.300;
    CCD[ 97].GPOS[1]=  9291.650;
    CCD[ 97].GPOS[2]=  0.000000;
    CCD[ 98].GPOS[0]= 11712.000;
    CCD[ 98].GPOS[1]=-13387.650;
    CCD[ 98].GPOS[2]=  0.000000;
    CCD[ 99].GPOS[0]=-13760.000;
    CCD[ 99].GPOS[1]=  9291.650;
    CCD[ 99].GPOS[2]=  0.000000;
    CCD[100].GPOS[0]=  0000.000;
    CCD[100].GPOS[1]=  0000.000;
    CCD[100].GPOS[2]=  0.000000;

if(NUM_CCD>100){
    CCD[100].GPOS[0]=- 7467.700;
    CCD[100].GPOS[1]= 13543.650;
    CCD[100].GPOS[2]=  0.785398;
    CCD[101].GPOS[0]= 11643.000;
    CCD[101].GPOS[1]= 13543.650;
    CCD[101].GPOS[2]=  0.785398;
    CCD[102].GPOS[0]= 11643.000;
    CCD[102].GPOS[1]=-15341.350;
    CCD[102].GPOS[2]=  0.785398;
    CCD[103].GPOS[0]=- 7467.700;
    CCD[103].GPOS[1]=-15341.350;
    CCD[103].GPOS[2]=  0.785398;
    CCD[104].GPOS[0]=  0000.000;
    CCD[104].GPOS[1]=  0000.000;
    CCD[104].GPOS[2]=  0.000000;
}
    for(CID=0;CID<NUM_CCD+1;CID++){
        CCD[CID].ID_CHIP=CID;
        CCD[CID].GPOS_INIT[0]=CCD[CID].GPOS[0];
        CCD[CID].GPOS_INIT[1]=CCD[CID].GPOS[1];
        CCD[CID].GPOS_INIT[2]=CCD[CID].GPOS[2];
 	CCD[CID].CRPIX[0]=0;
 	CCD[CID].CRPIX[1]=0;
  	CCD[CID].CRVAL[0]=CRVAL[0];
 	CCD[CID].CRVAL[1]=CRVAL[1];
 	CCD[CID].CD[0][0]=0;
 	CCD[CID].CD[0][1]=0;
 	CCD[CID].CD[1][0]=0;
 	CCD[CID].CD[1][1]=0;
 	CCD[CID].InvCD[0][0]=0;
 	CCD[CID].InvCD[0][1]=0;
 	CCD[CID].InvCD[1][0]=0;
 	CCD[CID].InvCD[1][1]=0;
	CCD[CID].NUM_OBJ=0;
	CCD[CID].NUM_FIT=0;
   }

}
